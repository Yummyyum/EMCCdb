{% extends "base.html" %}

{% block content %}
  {% include "navbar.html" %}

  {% if problem_committee %}
    <div class="page-header"><h1>Edit Problem</h1></div>
    <div class="panel panel-default" style="max-width: 500px">
      <div class="panel-heading">
        <h3 class="panel-title">Preview</h3>
      </div>
      <div class="panel-body" id="preview"></div>
    </div>
    <form method="post" action="/edit" class="form" style="max-width: 500px; margin-bottom: 30px">
      <div class="form-group">
        <label>Problem</label>
        <textarea class="form-control" name="problem" rows="5" id="problem">{{ problem.problem }}</textarea>
      </div>
      <div class="form-group">
        <label>Answer</label>
        <input type="text" class="form-control" name="answer" value="{{ problem.answer }}">
      </div>
      <div class="form-group">
        <label>Difficulty</label> <small>What percentage of participants will solve this?</small>
        <select class="form-control" name="difficulty" id="difficulty">
          <option value="">---------</option>
          <option value="100%">100%</option>
          <option value="75%">75%</option>
          <option value="50%">50%</option>
          <option value="25%">25%</option>
          <option value="5%">5%</option>
        </select>
      </div>
      <div class="form-group">
        <label>Tags</label> <small>A space separated list of tags. For example: "alg ari com nt geo".</small>
        <input type="text" class="form-control" name="tags"
          value="{% for tag in problem.tags %}{{ tag }} {% endfor %}">
      </div>
      <div class="form-group">
        <label>Comments</label>
        <textarea class="form-control" name="comments" rows="2">{{ problem.comments }}</textarea>
      </div>
      <input type="submit" class="btn btn-primary pull-right" value="Submit">
      <button type="button" onclick="update()" class="btn btn-secondary pull-right" style="margin-right: 5px">Preview</button>
      <input type="hidden" name="problem_id" value="{{ problem.key.id }}">
    </form>
  {% else %}
    <div class="alert alert-danger">
      Sorry, only problem committee members can edit submitted problems.
    </div>
  {% endif %}
{% endblock %}

{% block end %}
  <script src="static/latex_to_HTML.js"></script>

  <script type="text/javascript">
    $(document).ready(function(){
        $("#difficulty").val("{{ problem.difficulty }}");
        update();
    });
  </script>

  // updates preview
  <script>
    function update(){
      preview = document.getElementById("preview");
      val = document.getElementById("problem").value;
      val = latex_to_HTML(val);
      preview.innerHTML = val;
      MathJax.Hub.Queue(
        ["Typeset", MathJax.Hub, preview]
      );
    }
  </script>
{% endblock %}
